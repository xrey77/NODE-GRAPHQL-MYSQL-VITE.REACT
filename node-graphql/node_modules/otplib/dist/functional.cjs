"use strict";var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var x=(t,e)=>{for(var r in e)d(t,r,{get:e[r],enumerable:!0})},H=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of V(e))!b.call(t,o)&&o!==r&&d(t,o,{get:()=>e[o],enumerable:!(n=S(e,o))||n.enumerable});return t};var R=t=>H(d({},"__esModule",{value:!0}),t);var B={};x(B,{generate:()=>C,generateSecret:()=>v,generateSync:()=>D,generateURI:()=>G,verify:()=>w,verifySync:()=>k});module.exports=R(B);var l=require("@otplib/core"),c=require("@otplib/hotp"),g=require("@otplib/totp"),m=require("@otplib/uri");var P=require("@otplib/core"),f=require("@otplib/plugin-base32-scure"),T=require("@otplib/plugin-crypto-noble");function O(t){return{secret:t.secret,strategy:t.strategy??"totp",crypto:t.crypto??T.crypto,base32:t.base32??f.base32,algorithm:t.algorithm??"sha1",digits:t.digits??6,period:t.period??30,epoch:t.epoch??Math.floor(Date.now()/1e3),t0:t.t0??0,counter:t.counter,guardrails:t.guardrails??(0,P.createGuardrails)()}}function h(t){return{...O(t),token:t.token,epochTolerance:t.epochTolerance??0,counterTolerance:t.counterTolerance??0}}function y(t,e,r){if(t==="totp")return r.totp();if(t==="hotp"){if(e===void 0)throw new l.ConfigurationError("Counter is required for HOTP strategy. Example: { strategy: 'hotp', counter: 0 }");return r.hotp(e)}throw new l.ConfigurationError(`Unknown OTP strategy: ${t}. Valid strategies are 'totp' or 'hotp'.`)}function v(t){let{crypto:e=T.crypto,base32:r=f.base32,length:n=20}=t||{};return(0,l.generateSecret)({crypto:e,base32:r,length:n})}function G(t){let{strategy:e="totp",issuer:r,label:n,secret:o,algorithm:s="sha1",digits:p=6,period:a=30,counter:i}=t;return y(e,i,{totp:()=>(0,m.generateTOTP)({issuer:r,label:n,secret:o,algorithm:s,digits:p,period:a}),hotp:u=>(0,m.generateHOTP)({issuer:r,label:n,secret:o,algorithm:s,digits:p,counter:u})})}async function C(t){let e=O(t),{secret:r,crypto:n,base32:o,algorithm:s,digits:p}=e,a={secret:r,crypto:n,base32:o,algorithm:s,digits:p};return y(e.strategy,e.counter,{totp:()=>(0,g.generate)({...a,period:e.period,epoch:e.epoch,t0:e.t0,guardrails:e.guardrails}),hotp:i=>(0,c.generate)({...a,counter:i,guardrails:e.guardrails})})}function D(t){let e=O(t),{secret:r,crypto:n,base32:o,algorithm:s,digits:p}=e,a={secret:r,crypto:n,base32:o,algorithm:s,digits:p};return y(e.strategy,e.counter,{totp:()=>(0,g.generateSync)({...a,period:e.period,epoch:e.epoch,t0:e.t0,guardrails:e.guardrails}),hotp:i=>(0,c.generateSync)({...a,counter:i,guardrails:e.guardrails})})}async function w(t){let e=h(t),{secret:r,token:n,crypto:o,base32:s,algorithm:p,digits:a}=e,i={secret:r,token:n,crypto:o,base32:s,algorithm:p,digits:a};return y(e.strategy,e.counter,{totp:()=>(0,g.verify)({...i,period:e.period,epoch:e.epoch,t0:e.t0,epochTolerance:e.epochTolerance,guardrails:e.guardrails}),hotp:u=>(0,c.verify)({...i,counter:u,counterTolerance:e.counterTolerance,guardrails:e.guardrails})})}function k(t){let e=h(t),{secret:r,token:n,crypto:o,base32:s,algorithm:p,digits:a}=e,i={secret:r,token:n,crypto:o,base32:s,algorithm:p,digits:a};return y(e.strategy,e.counter,{totp:()=>(0,g.verifySync)({...i,period:e.period,epoch:e.epoch,t0:e.t0,epochTolerance:e.epochTolerance,guardrails:e.guardrails}),hotp:u=>(0,c.verifySync)({...i,counter:u,counterTolerance:e.counterTolerance,guardrails:e.guardrails})})}0&&(module.exports={generate,generateSecret,generateSync,generateURI,verify,verifySync});
//# sourceMappingURL=functional.cjs.map
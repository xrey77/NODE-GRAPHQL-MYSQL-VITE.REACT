"use strict";var T=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var D=Object.prototype.hasOwnProperty;var U=(r,e)=>{for(var t in e)T(r,t,{get:e[t],enumerable:!0})},B=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of C(e))!D.call(r,a)&&a!==t&&T(r,a,{get:()=>e[a],enumerable:!(i=v(e,a))||i.enumerable});return r};var A=r=>B(T({},"__esModule",{value:!0}),r);var I={};U(I,{OTP:()=>b});module.exports=A(I);var d=require("@otplib/core");var S=require("@otplib/core"),c=require("@otplib/plugin-base32-scure"),l=require("@otplib/plugin-crypto-noble");function m(r){return{secret:r.secret,strategy:r.strategy??"totp",crypto:r.crypto??l.crypto,base32:r.base32??c.base32,algorithm:r.algorithm??"sha1",digits:r.digits??6,period:r.period??30,epoch:r.epoch??Math.floor(Date.now()/1e3),t0:r.t0??0,counter:r.counter,guardrails:r.guardrails??(0,S.createGuardrails)()}}function P(r){return{...m(r),token:r.token,epochTolerance:r.epochTolerance??0,counterTolerance:r.counterTolerance??0}}var O=require("@otplib/core"),g=require("@otplib/hotp"),u=require("@otplib/totp"),h=require("@otplib/uri");function f(r,e,t){if(r==="totp")return t.totp();if(r==="hotp"){if(e===void 0)throw new O.ConfigurationError("Counter is required for HOTP strategy. Example: { strategy: 'hotp', counter: 0 }");return t.hotp(e)}throw new O.ConfigurationError(`Unknown OTP strategy: ${r}. Valid strategies are 'totp' or 'hotp'.`)}function V(r){let{strategy:e="totp",issuer:t,label:i,secret:a,algorithm:s="sha1",digits:p=6,period:o=30,counter:n}=r;return f(e,n,{totp:()=>(0,h.generateTOTP)({issuer:t,label:i,secret:a,algorithm:s,digits:p,period:o}),hotp:y=>(0,h.generateHOTP)({issuer:t,label:i,secret:a,algorithm:s,digits:p,counter:y})})}async function R(r){let e=m(r),{secret:t,crypto:i,base32:a,algorithm:s,digits:p}=e,o={secret:t,crypto:i,base32:a,algorithm:s,digits:p};return f(e.strategy,e.counter,{totp:()=>(0,u.generate)({...o,period:e.period,epoch:e.epoch,t0:e.t0,guardrails:e.guardrails}),hotp:n=>(0,g.generate)({...o,counter:n,guardrails:e.guardrails})})}function G(r){let e=m(r),{secret:t,crypto:i,base32:a,algorithm:s,digits:p}=e,o={secret:t,crypto:i,base32:a,algorithm:s,digits:p};return f(e.strategy,e.counter,{totp:()=>(0,u.generateSync)({...o,period:e.period,epoch:e.epoch,t0:e.t0,guardrails:e.guardrails}),hotp:n=>(0,g.generateSync)({...o,counter:n,guardrails:e.guardrails})})}async function x(r){let e=P(r),{secret:t,token:i,crypto:a,base32:s,algorithm:p,digits:o}=e,n={secret:t,token:i,crypto:a,base32:s,algorithm:p,digits:o};return f(e.strategy,e.counter,{totp:()=>(0,u.verify)({...n,period:e.period,epoch:e.epoch,t0:e.t0,epochTolerance:e.epochTolerance,guardrails:e.guardrails}),hotp:y=>(0,g.verify)({...n,counter:y,counterTolerance:e.counterTolerance,guardrails:e.guardrails})})}function H(r){let e=P(r),{secret:t,token:i,crypto:a,base32:s,algorithm:p,digits:o}=e,n={secret:t,token:i,crypto:a,base32:s,algorithm:p,digits:o};return f(e.strategy,e.counter,{totp:()=>(0,u.verifySync)({...n,period:e.period,epoch:e.epoch,t0:e.t0,epochTolerance:e.epochTolerance,guardrails:e.guardrails}),hotp:y=>(0,g.verifySync)({...n,counter:y,counterTolerance:e.counterTolerance,guardrails:e.guardrails})})}var b=class{strategy;crypto;base32;guardrails;constructor(e={}){let{strategy:t="totp",crypto:i=l.crypto,base32:a=c.base32,guardrails:s}=e;this.strategy=t,this.crypto=i,this.base32=a,this.guardrails=(0,d.createGuardrails)(s)}getStrategy(){return this.strategy}generateSecret(e=20){return(0,d.generateSecret)({crypto:this.crypto,base32:this.base32,length:e})}async generate(e){return R({...e,strategy:this.strategy,crypto:this.crypto,base32:this.base32,guardrails:e.guardrails??this.guardrails})}generateSync(e){return G({...e,strategy:this.strategy,crypto:this.crypto,base32:this.base32,guardrails:e.guardrails??this.guardrails})}async verify(e){return x({...e,strategy:this.strategy,crypto:this.crypto,base32:this.base32,guardrails:e.guardrails??this.guardrails})}verifySync(e){return H({...e,strategy:this.strategy,crypto:this.crypto,base32:this.base32,guardrails:e.guardrails??this.guardrails})}generateURI(e){return V({...e,strategy:this.strategy})}};0&&(module.exports={OTP});
//# sourceMappingURL=class.cjs.map
"use strict";var rr=Object.defineProperty;var Kr=Object.getOwnPropertyDescriptor;var zr=Object.getOwnPropertyNames;var Hr=Object.prototype.hasOwnProperty;var Fr=(r,e)=>{for(var t in e)rr(r,t,{get:e[t],enumerable:!0})},Vr=(r,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of zr(e))!Hr.call(r,n)&&n!==t&&rr(r,n,{get:()=>e[n],enumerable:!(o=Kr(e,n))||o.enumerable});return r};var Jr=r=>Vr(rr({},"__esModule",{value:!0}),r);var re={};Fr(re,{AfterTimeStepError:()=>g,AfterTimeStepNegativeError:()=>H,AfterTimeStepNotIntegerError:()=>F,AfterTimeStepRangeExceededError:()=>V,AlgorithmError:()=>z,Base32Context:()=>j,Base32DecodeError:()=>p,Base32EncodeError:()=>c,Base32Error:()=>R,Base32PluginMissingError:()=>k,ConfigurationError:()=>l,CounterError:()=>y,CounterNegativeError:()=>x,CounterOverflowError:()=>f,CounterToleranceError:()=>_,CounterToleranceNegativeError:()=>M,CounterToleranceTooLargeError:()=>v,CryptoContext:()=>Y,CryptoError:()=>S,CryptoPluginMissingError:()=>q,DEFAULT_PERIOD:()=>ir,DigitsError:()=>K,EpochToleranceError:()=>U,EpochToleranceNegativeError:()=>I,EpochToleranceTooLargeError:()=>D,HMACError:()=>u,IssuerMissingError:()=>X,LabelMissingError:()=>G,MAX_COUNTER:()=>ar,MAX_PERIOD:()=>sr,MAX_SECRET_BYTES:()=>tr,MAX_WINDOW:()=>ur,MIN_PERIOD:()=>or,MIN_SECRET_BYTES:()=>er,OTPError:()=>s,PeriodError:()=>P,PeriodTooLargeError:()=>b,PeriodTooSmallError:()=>O,PluginError:()=>N,RECOMMENDED_SECRET_BYTES:()=>nr,RandomBytesError:()=>w,SecretError:()=>d,SecretMissingError:()=>L,SecretTooLongError:()=>T,SecretTooShortError:()=>E,SecretTypeError:()=>$,TimeError:()=>W,TimeNegativeError:()=>h,TokenError:()=>A,TokenFormatError:()=>B,TokenLengthError:()=>C,bytesToString:()=>Br,constantTimeEqual:()=>Q,counterToBytes:()=>Or,createBase32Context:()=>Lr,createBase32Plugin:()=>Gr,createCryptoContext:()=>kr,createCryptoPlugin:()=>Xr,createGuardrails:()=>mr,dynamicTruncate:()=>br,generateSecret:()=>wr,getDigestSize:()=>Cr,hasBase32:()=>Yr,hasCrypto:()=>Wr,hasGuardrailOverrides:()=>dr,hasPlugins:()=>$r,normalizeCounterTolerance:()=>lr,normalizeEpochTolerance:()=>Rr,normalizeSecret:()=>Sr,requireBase32Plugin:()=>Z,requireBase32String:()=>Ur,requireCryptoPlugin:()=>gr,requireIssuer:()=>Mr,requireLabel:()=>vr,requireSecret:()=>_r,stringToBytes:()=>J,truncateDigits:()=>Ar,validateByteLengthEqual:()=>pr,validateCounter:()=>Tr,validateCounterTolerance:()=>hr,validateEpochTolerance:()=>Pr,validatePeriod:()=>xr,validateSecret:()=>Er,validateTime:()=>yr,validateToken:()=>fr,wrapResult:()=>Nr,wrapResultAsync:()=>qr});module.exports=Jr(re);var s=class extends Error{constructor(e,t){super(e,t),this.name="OTPError"}},d=class extends s{constructor(e){super(e),this.name="SecretError"}},E=class extends d{constructor(e,t){super(`Secret must be at least ${e} bytes (${e*8} bits), got ${t} bytes`),this.name="SecretTooShortError"}},T=class extends d{constructor(e,t){super(`Secret must not exceed ${e} bytes, got ${t} bytes`),this.name="SecretTooLongError"}},y=class extends s{constructor(e){super(e),this.name="CounterError"}},x=class extends y{constructor(){super("Counter must be non-negative"),this.name="CounterNegativeError"}},f=class extends y{constructor(){super("Counter exceeds maximum safe integer value"),this.name="CounterOverflowError"}},W=class extends s{constructor(e){super(e),this.name="TimeError"}},h=class extends W{constructor(){super("Time must be non-negative"),this.name="TimeNegativeError"}},P=class extends s{constructor(e){super(e),this.name="PeriodError"}},O=class extends P{constructor(e){super(`Period must be at least ${e} second(s)`),this.name="PeriodTooSmallError"}},b=class extends P{constructor(e){super(`Period must not exceed ${e} seconds`),this.name="PeriodTooLargeError"}},K=class extends s{constructor(e){super(e),this.name="DigitsError"}},z=class extends s{constructor(e){super(e),this.name="AlgorithmError"}},A=class extends s{constructor(e){super(e),this.name="TokenError"}},C=class extends A{constructor(e,t){super(`Token must be ${e} digits, got ${t}`),this.name="TokenLengthError"}},B=class extends A{constructor(){super("Token must contain only digits"),this.name="TokenFormatError"}},S=class extends s{constructor(e,t){super(e,t),this.name="CryptoError"}},u=class extends S{constructor(e,t){super(`HMAC computation failed: ${e}`,t),this.name="HMACError"}},w=class extends S{constructor(e,t){super(`Random byte generation failed: ${e}`,t),this.name="RandomBytesError"}},R=class extends s{constructor(e,t){super(e,t),this.name="Base32Error"}},c=class extends R{constructor(e,t){super(`Base32 encoding failed: ${e}`,t),this.name="Base32EncodeError"}},p=class extends R{constructor(e,t){super(`Base32 decoding failed: ${e}`,t),this.name="Base32DecodeError"}},_=class extends s{constructor(e){super(e),this.name="CounterToleranceError"}},v=class extends _{constructor(e,t){super(`Counter tolerance validation failed: total checks (${t}) exceeds MAX_WINDOW (${e})`),this.name="CounterToleranceTooLargeError"}},M=class extends _{constructor(){super("Counter tolerance cannot contain negative values"),this.name="CounterToleranceNegativeError"}},U=class extends s{constructor(e){super(e),this.name="EpochToleranceError"}},I=class extends U{constructor(){super("Epoch tolerance cannot contain negative values"),this.name="EpochToleranceNegativeError"}},D=class extends U{constructor(e,t){super(`Epoch tolerance must not exceed ${e} seconds, got ${t}. Large tolerances can cause performance issues.`),this.name="EpochToleranceTooLargeError"}},N=class extends s{constructor(e){super(e),this.name="PluginError"}},q=class extends N{constructor(){super("Crypto plugin is required."),this.name="CryptoPluginMissingError"}},k=class extends N{constructor(){super("Base32 plugin is required."),this.name="Base32PluginMissingError"}},l=class extends s{constructor(e){super(e),this.name="ConfigurationError"}},L=class extends l{constructor(){super("Secret is required. Use generateSecret() to create one, or provide via { secret: 'YOUR_BASE32_SECRET' }"),this.name="SecretMissingError"}},G=class extends l{constructor(){super("Label is required for URI generation. Example: { label: 'user@example.com' }"),this.name="LabelMissingError"}},X=class extends l{constructor(){super("Issuer is required for URI generation. Example: { issuer: 'MyApp' }"),this.name="IssuerMissingError"}},$=class extends l{constructor(){super("Class API requires secret to be a Base32 string, not Uint8Array. Use generateSecret() or provide a Base32-encoded string."),this.name="SecretTypeError"}},g=class extends s{constructor(e){super(e),this.name="AfterTimeStepError"}},H=class extends g{constructor(){super("afterTimeStep must be >= 0"),this.name="AfterTimeStepNegativeError"}},F=class extends g{constructor(){super("Invalid afterTimeStep: non-integer value"),this.name="AfterTimeStepNotIntegerError"}},V=class extends g{constructor(){super("Invalid afterTimeStep: cannot be greater than current time step plus window"),this.name="AfterTimeStepRangeExceededError"}};var Qr=new TextEncoder,Zr=new TextDecoder,er=16,tr=64,nr=20,or=1,sr=3600,ir=30,ar=Number.MAX_SAFE_INTEGER,ur=99,cr=Symbol("otplib.guardrails.override"),m=Object.freeze({MIN_SECRET_BYTES:er,MAX_SECRET_BYTES:tr,MIN_PERIOD:or,MAX_PERIOD:sr,MAX_COUNTER:ar,MAX_WINDOW:ur,[cr]:!1});function mr(r){return r?Object.freeze({...m,...r,[cr]:!0}):m}function dr(r){return r[cr]??!1}function Er(r,e=m){if(r.length<e.MIN_SECRET_BYTES)throw new E(e.MIN_SECRET_BYTES,r.length);if(r.length>e.MAX_SECRET_BYTES)throw new T(e.MAX_SECRET_BYTES,r.length)}function Tr(r,e=m){let t=typeof r=="bigint"?r:BigInt(r);if(t<0n)throw new x;if(t>BigInt(e.MAX_COUNTER))throw new f}function yr(r){if(r<0)throw new h}function xr(r,e=m){if(!Number.isInteger(r)||r<e.MIN_PERIOD)throw new O(e.MIN_PERIOD);if(r>e.MAX_PERIOD)throw new b(e.MAX_PERIOD)}function fr(r,e){if(r.length!==e)throw new C(e,r.length);if(!/^\d+$/.test(r))throw new B}function hr(r,e=m){let[t,o]=lr(r);if(t<0||o<0)throw new M;let n=t+o+1;if(n>e.MAX_WINDOW)throw new v(e.MAX_WINDOW,n)}function Pr(r,e=ir,t=m){let[o,n]=Array.isArray(r)?r:[r,r];if(o<0||n<0)throw new I;let i=t.MAX_WINDOW*e,a=Math.max(o,n);if(a>i)throw new D(i,a)}function Or(r){let e=typeof r=="bigint"?r:BigInt(r),t=new ArrayBuffer(8);return new DataView(t).setBigUint64(0,e,!1),new Uint8Array(t)}function br(r){let e=r[r.length-1]&15;return(r[e]&127)<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function Ar(r,e){let t=10**e;return(r%t).toString().padStart(e,"0")}function pr(r,e){return r.length===e.length}function Q(r,e){let t=J(r),o=J(e);if(!pr(t,o))return!1;let n=0;for(let i=0;i<t.length;i++)n|=t[i]^o[i];return n===0}function Cr(r){switch(r){case"sha1":return 20;case"sha256":return 32;case"sha512":return 64}}function J(r){return typeof r=="string"?Qr.encode(r):r}function Br(r){return Zr.decode(r)}function Sr(r,e){return typeof r=="string"?(Z(e),e.decode(r)):r}function wr(r){let{crypto:e,base32:t,length:o=nr}=r;gr(e),Z(t);let n=e.randomBytes(o);return t.encode(n,{padding:!1})}function lr(r=0){return Array.isArray(r)?r:[0,r]}function Rr(r=0){return Array.isArray(r)?r:[r,r]}function gr(r){if(!r)throw new q}function Z(r){if(!r)throw new k}function _r(r){if(!r)throw new L}function vr(r){if(!r)throw new G}function Mr(r){if(!r)throw new X}function Ur(r){if(typeof r!="string")throw new $}function Ir(r){return{ok:!0,value:r}}function Dr(r){return{ok:!1,error:r}}function Nr(r){return(...e)=>{try{return Ir(r(...e))}catch(t){return Dr(t)}}}function qr(r){return async(...e)=>{try{return Ir(await r(...e))}catch(t){return Dr(t)}}}var Y=class{constructor(e){this.crypto=e}get plugin(){return this.crypto}async hmac(e,t,o){try{let n=this.crypto.hmac(e,t,o);return n instanceof Promise?await n:n}catch(n){let i=n instanceof Error?n.message:String(n);throw new u(i,{cause:n})}}hmacSync(e,t,o){try{let n=this.crypto.hmac(e,t,o);if(n instanceof Promise)throw new u("Crypto plugin does not support synchronous HMAC operations");return n}catch(n){if(n instanceof u)throw n;let i=n instanceof Error?n.message:String(n);throw new u(i,{cause:n})}}randomBytes(e){try{return this.crypto.randomBytes(e)}catch(t){let o=t instanceof Error?t.message:String(t);throw new w(o,{cause:t})}}};function kr(r){return new Y(r)}var j=class{constructor(e){this.base32=e}get plugin(){return this.base32}encode(e,t){try{return this.base32.encode(e,t)}catch(o){let n=o instanceof Error?o.message:String(o);throw new c(n,{cause:o})}}decode(e){try{return this.base32.decode(e)}catch(t){let o=t instanceof Error?t.message:String(t);throw new p(o,{cause:t})}}};function Lr(r){return new j(r)}function Gr(r){let{name:e="custom",encode:t,decode:o}=r;return Object.freeze({name:e,encode:(n,i)=>{try{return t(n)}catch(a){let jr=a instanceof Error?a.message:String(a);throw new c(jr,{cause:a})}},decode:n=>{try{return o(n)}catch(i){let a=i instanceof Error?i.message:String(i);throw new p(a,{cause:i})}}})}function Xr(r){let{name:e="custom",hmac:t,randomBytes:o,constantTimeEqual:n}=r;return Object.freeze({name:e,hmac:t,randomBytes:o,constantTimeEqual:n??Q})}function $r(r){return r.crypto!==void 0&&r.base32!==void 0}function Wr(r){return r.crypto!==void 0}function Yr(r){return r.base32!==void 0}0&&(module.exports={AfterTimeStepError,AfterTimeStepNegativeError,AfterTimeStepNotIntegerError,AfterTimeStepRangeExceededError,AlgorithmError,Base32Context,Base32DecodeError,Base32EncodeError,Base32Error,Base32PluginMissingError,ConfigurationError,CounterError,CounterNegativeError,CounterOverflowError,CounterToleranceError,CounterToleranceNegativeError,CounterToleranceTooLargeError,CryptoContext,CryptoError,CryptoPluginMissingError,DEFAULT_PERIOD,DigitsError,EpochToleranceError,EpochToleranceNegativeError,EpochToleranceTooLargeError,HMACError,IssuerMissingError,LabelMissingError,MAX_COUNTER,MAX_PERIOD,MAX_SECRET_BYTES,MAX_WINDOW,MIN_PERIOD,MIN_SECRET_BYTES,OTPError,PeriodError,PeriodTooLargeError,PeriodTooSmallError,PluginError,RECOMMENDED_SECRET_BYTES,RandomBytesError,SecretError,SecretMissingError,SecretTooLongError,SecretTooShortError,SecretTypeError,TimeError,TimeNegativeError,TokenError,TokenFormatError,TokenLengthError,bytesToString,constantTimeEqual,counterToBytes,createBase32Context,createBase32Plugin,createCryptoContext,createCryptoPlugin,createGuardrails,dynamicTruncate,generateSecret,getDigestSize,hasBase32,hasCrypto,hasGuardrailOverrides,hasPlugins,normalizeCounterTolerance,normalizeEpochTolerance,normalizeSecret,requireBase32Plugin,requireBase32String,requireCryptoPlugin,requireIssuer,requireLabel,requireSecret,stringToBytes,truncateDigits,validateByteLengthEqual,validateCounter,validateCounterTolerance,validateEpochTolerance,validatePeriod,validateSecret,validateTime,validateToken,wrapResult,wrapResultAsync});
//# sourceMappingURL=index.cjs.map
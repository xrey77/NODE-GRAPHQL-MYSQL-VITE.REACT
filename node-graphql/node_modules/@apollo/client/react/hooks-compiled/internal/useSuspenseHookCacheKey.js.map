{"version":3,"file":"useSuspenseHookCacheKey.js","sources":["../../../../src/react/hooks/internal/useSuspenseHookCacheKey.ts"],"sourcesContent":["import type { DocumentNode } from \"graphql\";\nimport * as React from \"react\";\n\nimport type { OperationVariables } from \"@apollo/client\";\nimport type { CacheKey } from \"@apollo/client/react/internal\";\nimport { canonicalStringify } from \"@apollo/client/utilities\";\n\nimport type { SkipToken } from \"../constants.js\";\nimport { skipToken } from \"../constants.js\";\n\nexport declare namespace useSuspenseHookCacheKey {\n  export interface Options {\n    variables?: OperationVariables;\n    queryKey?: string | number | any[];\n  }\n}\n\nexport function useSuspenseHookCacheKey(\n  query: DocumentNode,\n  options:\n    | (SkipToken & Partial<useSuspenseHookCacheKey.Options>)\n    | useSuspenseHookCacheKey.Options\n) {\n  const { queryKey = [], variables } = options;\n  const canonicalVariables = canonicalStringify(variables);\n\n  // This state value let's us maintain the variables used for the cache key\n  // when `skipToken` is used to skip a query after its been executed.\n  // Since options aren't provided when using `skipToken`, `variables` would\n  // otherwise disappear which means we'd return a new cache key without a\n  // variables value which creates a new `ObservableQuery` instance. This was\n  // particularly problematic when `refetchQueries` was used because it meant\n  // refetching against an `ObservableQuery` instance that had no variables.\n  let [cacheKeyVariables, setCacheKeyVariables] =\n    React.useState(canonicalVariables);\n\n  if (options !== skipToken && cacheKeyVariables !== canonicalVariables) {\n    setCacheKeyVariables((cacheKeyVariables = canonicalVariables));\n  }\n\n  return [\n    query,\n    cacheKeyVariables,\n    ...([] as any[]).concat(queryKey),\n  ] satisfies CacheKey;\n}\n"],"names":[],"mappings":";AACA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAO,EAAP,CAAA,EAAY,CAAZ,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,CAAA,EAAuB,CAAvB,CAAA,CAAA,CAAA,CAAA,CAAA,CAA8B;AAI9B,CAAA,CAAA,CAAA,CAAA,CAAA,EAAO,EAAE,CAAT,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,CAAA,EAAmC,CAAnC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAA6D;AAG7D,CAAA,CAAA,CAAA,CAAA,CAAA,EAAO,EAAE,CAAT,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,CAAA,EAA0B,CAA1B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAA2C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}